2024-06-13 13:18:49,077 - INFO - Starting analysis for stock symbol: NVDA
2024-06-13 13:18:49,078 - INFO - Test ratio: 0.3, Future days: 30
2024-06-13 13:18:49,078 - INFO - Downloading stock data for NVDA
2024-06-13 13:18:49,610 - INFO - Downloaded data shape: (3522, 6)
2024-06-13 13:18:49,611 - INFO - Adding technical indicators
2024-06-13 13:18:49,614 - INFO - Technical indicators added. Updated data shape: (3473, 4)
2024-06-13 13:18:49,615 - INFO - Scaling the data
2024-06-13 13:18:49,617 - INFO - Data scaled successfully
2024-06-13 13:18:49,618 - INFO - Preparing dataset
2024-06-13 13:18:49,625 - INFO - Dataset prepared. X shape: (3413, 60, 4), y shape: (3413,)
2024-06-13 13:18:49,625 - INFO - Pre-training model on interpolation task
2024-06-13 13:19:53,236 - INFO - Loading pre-trained weights for extrapolation task
2024-06-13 13:19:53,714 - INFO - Fine-tuning model on extrapolation task
2024-06-13 13:21:01,834 - INFO - Making predictions
2024-06-13 13:21:02,866 - INFO - Rescaling predictions
2024-06-13 13:21:02,866 - INFO - Initial last_sequence shape: (60, 4)
2024-06-13 13:21:02,867 - INFO - Initial last_sequence sample: [[0.88600632 0.09536932 0.90775178 0.96101883]
 [0.90740631 0.10659768 0.90795038 0.96095939]
 [0.89766271 0.09980879 0.90804968 0.96032327]
 [0.90812362 0.08854205 0.90901967 0.9599223 ]
 [0.92820849 0.09116181 0.91040044 0.96005107]]
2024-06-13 13:21:02,946 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:02,947 - INFO - Updated last_sequence sample during iteration: [[0.97748419 0.05443941 0.99401074 0.99300907]
 [0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86650437 0.         0.         0.        ]]
2024-06-13 13:21:03,011 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,012 - INFO - Updated last_sequence sample during iteration: [[0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86650437 0.         0.         0.        ]
 [0.8641125  0.         0.         0.        ]]
2024-06-13 13:21:03,078 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,079 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86650437 0.         0.         0.        ]
 [0.8641125  0.         0.         0.        ]
 [0.85635531 0.         0.         0.        ]]
2024-06-13 13:21:03,152 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,153 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.09422052 1.         1.        ]
 [0.86650437 0.         0.         0.        ]
 [0.8641125  0.         0.         0.        ]
 [0.85635531 0.         0.         0.        ]
 [0.901034   0.         0.         0.        ]]
2024-06-13 13:21:03,229 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,230 - INFO - Updated last_sequence sample during iteration: [[0.86650437 0.         0.         0.        ]
 [0.8641125  0.         0.         0.        ]
 [0.85635531 0.         0.         0.        ]
 [0.901034   0.         0.         0.        ]
 [0.84420431 0.         0.         0.        ]]
2024-06-13 13:21:03,281 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,282 - INFO - Updated last_sequence sample during iteration: [[0.8641125  0.         0.         0.        ]
 [0.85635531 0.         0.         0.        ]
 [0.901034   0.         0.         0.        ]
 [0.84420431 0.         0.         0.        ]
 [0.87309736 0.         0.         0.        ]]
2024-06-13 13:21:03,354 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,356 - INFO - Updated last_sequence sample during iteration: [[0.85635531 0.         0.         0.        ]
 [0.901034   0.         0.         0.        ]
 [0.84420431 0.         0.         0.        ]
 [0.87309736 0.         0.         0.        ]
 [0.81770098 0.         0.         0.        ]]
2024-06-13 13:21:03,451 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,452 - INFO - Updated last_sequence sample during iteration: [[0.901034   0.         0.         0.        ]
 [0.84420431 0.         0.         0.        ]
 [0.87309736 0.         0.         0.        ]
 [0.81770098 0.         0.         0.        ]
 [0.8263337  0.         0.         0.        ]]
2024-06-13 13:21:03,531 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,532 - INFO - Updated last_sequence sample during iteration: [[0.84420431 0.         0.         0.        ]
 [0.87309736 0.         0.         0.        ]
 [0.81770098 0.         0.         0.        ]
 [0.8263337  0.         0.         0.        ]
 [0.7784766  0.         0.         0.        ]]
2024-06-13 13:21:03,596 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,597 - INFO - Updated last_sequence sample during iteration: [[0.87309736 0.         0.         0.        ]
 [0.81770098 0.         0.         0.        ]
 [0.8263337  0.         0.         0.        ]
 [0.7784766  0.         0.         0.        ]
 [0.77067429 0.         0.         0.        ]]
2024-06-13 13:21:03,671 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,672 - INFO - Updated last_sequence sample during iteration: [[0.81770098 0.         0.         0.        ]
 [0.8263337  0.         0.         0.        ]
 [0.7784766  0.         0.         0.        ]
 [0.77067429 0.         0.         0.        ]
 [0.73023599 0.         0.         0.        ]]
2024-06-13 13:21:03,723 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,723 - INFO - Updated last_sequence sample during iteration: [[0.8263337  0.         0.         0.        ]
 [0.7784766  0.         0.         0.        ]
 [0.77067429 0.         0.         0.        ]
 [0.73023599 0.         0.         0.        ]
 [0.71144086 0.         0.         0.        ]]
2024-06-13 13:21:03,797 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,798 - INFO - Updated last_sequence sample during iteration: [[0.7784766  0.         0.         0.        ]
 [0.77067429 0.         0.         0.        ]
 [0.73023599 0.         0.         0.        ]
 [0.71144086 0.         0.         0.        ]
 [0.67670166 0.         0.         0.        ]]
2024-06-13 13:21:03,876 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,876 - INFO - Updated last_sequence sample during iteration: [[0.77067429 0.         0.         0.        ]
 [0.73023599 0.         0.         0.        ]
 [0.71144086 0.         0.         0.        ]
 [0.67670166 0.         0.         0.        ]
 [0.65127426 0.         0.         0.        ]]
2024-06-13 13:21:03,930 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:03,931 - INFO - Updated last_sequence sample during iteration: [[0.73023599 0.         0.         0.        ]
 [0.71144086 0.         0.         0.        ]
 [0.67670166 0.         0.         0.        ]
 [0.65127426 0.         0.         0.        ]
 [0.62067103 0.         0.         0.        ]]
2024-06-13 13:21:04,006 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,007 - INFO - Updated last_sequence sample during iteration: [[0.71144086 0.         0.         0.        ]
 [0.67670166 0.         0.         0.        ]
 [0.65127426 0.         0.         0.        ]
 [0.62067103 0.         0.         0.        ]
 [0.59164619 0.         0.         0.        ]]
2024-06-13 13:21:04,075 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,076 - INFO - Updated last_sequence sample during iteration: [[0.67670166 0.         0.         0.        ]
 [0.65127426 0.         0.         0.        ]
 [0.62067103 0.         0.         0.        ]
 [0.59164619 0.         0.         0.        ]
 [0.56404835 0.         0.         0.        ]]
2024-06-13 13:21:04,154 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,154 - INFO - Updated last_sequence sample during iteration: [[0.65127426 0.         0.         0.        ]
 [0.62067103 0.         0.         0.        ]
 [0.59164619 0.         0.         0.        ]
 [0.56404835 0.         0.         0.        ]
 [0.53347611 0.         0.         0.        ]]
2024-06-13 13:21:04,229 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,230 - INFO - Updated last_sequence sample during iteration: [[0.62067103 0.         0.         0.        ]
 [0.59164619 0.         0.         0.        ]
 [0.56404835 0.         0.         0.        ]
 [0.53347611 0.         0.         0.        ]
 [0.50811291 0.         0.         0.        ]]
2024-06-13 13:21:04,301 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,302 - INFO - Updated last_sequence sample during iteration: [[0.59164619 0.         0.         0.        ]
 [0.56404835 0.         0.         0.        ]
 [0.53347611 0.         0.         0.        ]
 [0.50811291 0.         0.         0.        ]
 [0.47738215 0.         0.         0.        ]]
2024-06-13 13:21:04,365 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,366 - INFO - Updated last_sequence sample during iteration: [[0.56404835 0.         0.         0.        ]
 [0.53347611 0.         0.         0.        ]
 [0.50811291 0.         0.         0.        ]
 [0.47738215 0.         0.         0.        ]
 [0.4537358  0.         0.         0.        ]]
2024-06-13 13:21:04,444 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,445 - INFO - Updated last_sequence sample during iteration: [[0.53347611 0.         0.         0.        ]
 [0.50811291 0.         0.         0.        ]
 [0.47738215 0.         0.         0.        ]
 [0.4537358  0.         0.         0.        ]
 [0.42375737 0.         0.         0.        ]]
2024-06-13 13:21:04,531 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,531 - INFO - Updated last_sequence sample during iteration: [[0.50811291 0.         0.         0.        ]
 [0.47738215 0.         0.         0.        ]
 [0.4537358  0.         0.         0.        ]
 [0.42375737 0.         0.         0.        ]
 [0.40148777 0.         0.         0.        ]]
2024-06-13 13:21:04,621 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,622 - INFO - Updated last_sequence sample during iteration: [[0.47738215 0.         0.         0.        ]
 [0.4537358  0.         0.         0.        ]
 [0.42375737 0.         0.         0.        ]
 [0.40148777 0.         0.         0.        ]
 [0.37284178 0.         0.         0.        ]]
2024-06-13 13:21:04,703 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,704 - INFO - Updated last_sequence sample during iteration: [[0.4537358  0.         0.         0.        ]
 [0.42375737 0.         0.         0.        ]
 [0.40148777 0.         0.         0.        ]
 [0.37284178 0.         0.         0.        ]
 [0.35174772 0.         0.         0.        ]]
2024-06-13 13:21:04,773 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,773 - INFO - Updated last_sequence sample during iteration: [[0.42375737 0.         0.         0.        ]
 [0.40148777 0.         0.         0.        ]
 [0.37284178 0.         0.         0.        ]
 [0.35174772 0.         0.         0.        ]
 [0.32477623 0.         0.         0.        ]]
2024-06-13 13:21:04,844 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,845 - INFO - Updated last_sequence sample during iteration: [[0.40148777 0.         0.         0.        ]
 [0.37284178 0.         0.         0.        ]
 [0.35174772 0.         0.         0.        ]
 [0.32477623 0.         0.         0.        ]
 [0.30474263 0.         0.         0.        ]]
2024-06-13 13:21:04,910 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,911 - INFO - Updated last_sequence sample during iteration: [[0.37284178 0.         0.         0.        ]
 [0.35174772 0.         0.         0.        ]
 [0.32477623 0.         0.         0.        ]
 [0.30474263 0.         0.         0.        ]
 [0.27962232 0.         0.         0.        ]]
2024-06-13 13:21:04,988 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:04,989 - INFO - Updated last_sequence sample during iteration: [[0.35174772 0.         0.         0.        ]
 [0.32477623 0.         0.         0.        ]
 [0.30474263 0.         0.         0.        ]
 [0.27962232 0.         0.         0.        ]
 [0.26058972 0.         0.         0.        ]]
2024-06-13 13:21:05,052 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 13:21:05,053 - INFO - Updated last_sequence sample during iteration: [[0.32477623 0.         0.         0.        ]
 [0.30474263 0.         0.         0.        ]
 [0.27962232 0.         0.         0.        ]
 [0.26058972 0.         0.         0.        ]
 [0.23744142 0.         0.         0.        ]]
2024-06-13 13:21:05,054 - INFO - Future predictions before rescaling: [0.8665044  0.8641125  0.8563553  0.901034   0.8442043  0.87309736
 0.817701   0.8263337  0.7784766  0.7706743  0.730236   0.71144086
 0.67670166 0.65127426 0.62067103 0.5916462  0.56404835 0.5334761
 0.5081129  0.47738215 0.4537358  0.42375737 0.40148777 0.37284178
 0.35174772 0.32477623 0.30474263 0.27962232 0.26058972 0.23744142]
2024-06-13 13:21:05,055 - INFO - Future predictions after rescaling: [43.70925522 43.5892142  43.19990426 45.44219359 42.59008187 44.04013756
 41.25995951 41.69320981 39.29140523 38.89983081 36.87035411 35.92708279
 34.18362673 32.90750174 31.37161742 29.9149478  28.52989476 26.99556596
 25.72266269 24.18037832 22.99363871 21.48911151 20.37146676 18.93381033
 17.87516304 16.5215449  15.51611871 14.2554053  13.30021632 12.13847267]
2024-06-13 13:21:05,055 - INFO - Future predictions DataFrame:
2024-06-13 13:21:05,056 - INFO -             Future Predictions
2023-12-30           43.709255
2023-12-31           43.589214
2024-01-01           43.199904
2024-01-02           45.442194
2024-01-03           42.590082
2024-06-13 13:21:05,067 - INFO - Plotting results
2024-06-13 15:12:24,822 - INFO - Starting analysis for stock symbol: NVDA
2024-06-13 15:12:24,822 - INFO - Test ratio: 0.5, Future days: 30
2024-06-13 15:12:24,822 - INFO - Downloading stock data for NVDA
2024-06-13 15:12:25,250 - INFO - Downloaded data shape: (3522, 6)
2024-06-13 15:12:25,251 - INFO - Adding technical indicators
2024-06-13 15:12:25,254 - INFO - Technical indicators added. Updated data shape: (3473, 4)
2024-06-13 15:12:25,254 - INFO - Scaling the data
2024-06-13 15:12:25,259 - INFO - Data scaled successfully
2024-06-13 15:12:25,259 - INFO - Preparing dataset
2024-06-13 15:12:25,268 - INFO - Dataset prepared. X shape: (3413, 60, 4), y shape: (3413,)
2024-06-13 15:12:25,268 - INFO - Pre-training model on interpolation task
2024-06-13 15:13:51,923 - INFO - Loading pre-trained weights for extrapolation task
2024-06-13 15:13:52,399 - INFO - Fine-tuning model on extrapolation task
2024-06-13 15:14:36,223 - INFO - Making predictions
2024-06-13 15:14:37,221 - INFO - Rescaling predictions
2024-06-13 15:14:37,221 - INFO - Initial last_sequence shape: (60, 4)
2024-06-13 15:14:37,222 - INFO - Initial last_sequence sample: [[0.88600632 0.09536932 0.90775178 0.96101883]
 [0.90740631 0.10659768 0.90795038 0.96095939]
 [0.89766271 0.09980879 0.90804968 0.96032327]
 [0.90812362 0.08854205 0.90901967 0.9599223 ]
 [0.92820849 0.09116181 0.91040044 0.96005107]]
2024-06-13 15:14:37,295 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,296 - INFO - Updated last_sequence sample during iteration: [[0.97748419 0.05443941 0.99401074 0.99300907]
 [0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.90760189 0.         0.         0.        ]]
2024-06-13 15:14:37,361 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,362 - INFO - Updated last_sequence sample during iteration: [[0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.90760189 0.         0.         0.        ]
 [0.9336502  0.         0.         0.        ]]
2024-06-13 15:14:37,418 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,419 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.90760189 0.         0.         0.        ]
 [0.9336502  0.         0.         0.        ]
 [0.93375951 0.         0.         0.        ]]
2024-06-13 15:14:37,491 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,492 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.09422052 1.         1.        ]
 [0.90760189 0.         0.         0.        ]
 [0.9336502  0.         0.         0.        ]
 [0.93375951 0.         0.         0.        ]
 [0.94299632 0.         0.         0.        ]]
2024-06-13 15:14:37,575 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,575 - INFO - Updated last_sequence sample during iteration: [[0.90760189 0.         0.         0.        ]
 [0.9336502  0.         0.         0.        ]
 [0.93375951 0.         0.         0.        ]
 [0.94299632 0.         0.         0.        ]
 [0.90231031 0.         0.         0.        ]]
2024-06-13 15:14:37,631 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,631 - INFO - Updated last_sequence sample during iteration: [[0.9336502  0.         0.         0.        ]
 [0.93375951 0.         0.         0.        ]
 [0.94299632 0.         0.         0.        ]
 [0.90231031 0.         0.         0.        ]
 [0.89843029 0.         0.         0.        ]]
2024-06-13 15:14:37,705 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,706 - INFO - Updated last_sequence sample during iteration: [[0.93375951 0.         0.         0.        ]
 [0.94299632 0.         0.         0.        ]
 [0.90231031 0.         0.         0.        ]
 [0.89843029 0.         0.         0.        ]
 [0.84891528 0.         0.         0.        ]]
2024-06-13 15:14:37,786 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,786 - INFO - Updated last_sequence sample during iteration: [[0.94299632 0.         0.         0.        ]
 [0.90231031 0.         0.         0.        ]
 [0.89843029 0.         0.         0.        ]
 [0.84891528 0.         0.         0.        ]
 [0.83436847 0.         0.         0.        ]]
2024-06-13 15:14:37,865 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,866 - INFO - Updated last_sequence sample during iteration: [[0.90231031 0.         0.         0.        ]
 [0.89843029 0.         0.         0.        ]
 [0.84891528 0.         0.         0.        ]
 [0.83436847 0.         0.         0.        ]
 [0.78415352 0.         0.         0.        ]]
2024-06-13 15:14:37,927 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,928 - INFO - Updated last_sequence sample during iteration: [[0.89843029 0.         0.         0.        ]
 [0.84891528 0.         0.         0.        ]
 [0.83436847 0.         0.         0.        ]
 [0.78415352 0.         0.         0.        ]
 [0.76135778 0.         0.         0.        ]]
2024-06-13 15:14:37,998 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:37,999 - INFO - Updated last_sequence sample during iteration: [[0.84891528 0.         0.         0.        ]
 [0.83436847 0.         0.         0.        ]
 [0.78415352 0.         0.         0.        ]
 [0.76135778 0.         0.         0.        ]
 [0.71350455 0.         0.         0.        ]]
2024-06-13 15:14:38,072 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,073 - INFO - Updated last_sequence sample during iteration: [[0.83436847 0.         0.         0.        ]
 [0.78415352 0.         0.         0.        ]
 [0.76135778 0.         0.         0.        ]
 [0.71350455 0.         0.         0.        ]
 [0.68496913 0.         0.         0.        ]]
2024-06-13 15:14:38,131 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,132 - INFO - Updated last_sequence sample during iteration: [[0.78415352 0.         0.         0.        ]
 [0.76135778 0.         0.         0.        ]
 [0.71350455 0.         0.         0.        ]
 [0.68496913 0.         0.         0.        ]
 [0.64037955 0.         0.         0.        ]]
2024-06-13 15:14:38,206 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,207 - INFO - Updated last_sequence sample during iteration: [[0.76135778 0.         0.         0.        ]
 [0.71350455 0.         0.         0.        ]
 [0.68496913 0.         0.         0.        ]
 [0.64037955 0.         0.         0.        ]
 [0.60837096 0.         0.         0.        ]]
2024-06-13 15:14:38,281 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,281 - INFO - Updated last_sequence sample during iteration: [[0.71350455 0.         0.         0.        ]
 [0.68496913 0.         0.         0.        ]
 [0.64037955 0.         0.         0.        ]
 [0.60837096 0.         0.         0.        ]
 [0.56720066 0.         0.         0.        ]]
2024-06-13 15:14:38,339 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,340 - INFO - Updated last_sequence sample during iteration: [[0.68496913 0.         0.         0.        ]
 [0.64037955 0.         0.         0.        ]
 [0.60837096 0.         0.         0.        ]
 [0.56720066 0.         0.         0.        ]
 [0.53360903 0.         0.         0.        ]]
2024-06-13 15:14:38,409 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,410 - INFO - Updated last_sequence sample during iteration: [[0.64037955 0.         0.         0.        ]
 [0.60837096 0.         0.         0.        ]
 [0.56720066 0.         0.         0.        ]
 [0.53360903 0.         0.         0.        ]
 [0.4958581  0.         0.         0.        ]]
2024-06-13 15:14:38,485 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,485 - INFO - Updated last_sequence sample during iteration: [[0.60837096 0.         0.         0.        ]
 [0.56720066 0.         0.         0.        ]
 [0.53360903 0.         0.         0.        ]
 [0.4958581  0.         0.         0.        ]
 [0.46217009 0.         0.         0.        ]]
2024-06-13 15:14:38,555 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,556 - INFO - Updated last_sequence sample during iteration: [[0.56720066 0.         0.         0.        ]
 [0.53360903 0.         0.         0.        ]
 [0.4958581  0.         0.         0.        ]
 [0.46217009 0.         0.         0.        ]
 [0.42766958 0.         0.         0.        ]]
2024-06-13 15:14:38,612 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,612 - INFO - Updated last_sequence sample during iteration: [[0.53360903 0.         0.         0.        ]
 [0.4958581  0.         0.         0.        ]
 [0.46217009 0.         0.         0.        ]
 [0.42766958 0.         0.         0.        ]
 [0.39499882 0.         0.         0.        ]]
2024-06-13 15:14:38,692 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,692 - INFO - Updated last_sequence sample during iteration: [[0.4958581  0.         0.         0.        ]
 [0.46217009 0.         0.         0.        ]
 [0.42766958 0.         0.         0.        ]
 [0.39499882 0.         0.         0.        ]
 [0.36356598 0.         0.         0.        ]]
2024-06-13 15:14:38,785 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,786 - INFO - Updated last_sequence sample during iteration: [[0.46217009 0.         0.         0.        ]
 [0.42766958 0.         0.         0.        ]
 [0.39499882 0.         0.         0.        ]
 [0.36356598 0.         0.         0.        ]
 [0.33269742 0.         0.         0.        ]]
2024-06-13 15:14:38,868 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,869 - INFO - Updated last_sequence sample during iteration: [[0.42766958 0.         0.         0.        ]
 [0.39499882 0.         0.         0.        ]
 [0.36356598 0.         0.         0.        ]
 [0.33269742 0.         0.         0.        ]
 [0.30416894 0.         0.         0.        ]]
2024-06-13 15:14:38,954 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:38,955 - INFO - Updated last_sequence sample during iteration: [[0.39499882 0.         0.         0.        ]
 [0.36356598 0.         0.         0.        ]
 [0.33269742 0.         0.         0.        ]
 [0.30416894 0.         0.         0.        ]
 [0.27561286 0.         0.         0.        ]]
2024-06-13 15:14:39,011 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:39,012 - INFO - Updated last_sequence sample during iteration: [[0.36356598 0.         0.         0.        ]
 [0.33269742 0.         0.         0.        ]
 [0.30416894 0.         0.         0.        ]
 [0.27561286 0.         0.         0.        ]
 [0.24984607 0.         0.         0.        ]]
2024-06-13 15:14:39,098 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:39,099 - INFO - Updated last_sequence sample during iteration: [[0.33269742 0.         0.         0.        ]
 [0.30416894 0.         0.         0.        ]
 [0.27561286 0.         0.         0.        ]
 [0.24984607 0.         0.         0.        ]
 [0.22389077 0.         0.         0.        ]]
2024-06-13 15:14:39,175 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:39,176 - INFO - Updated last_sequence sample during iteration: [[0.30416894 0.         0.         0.        ]
 [0.27561286 0.         0.         0.        ]
 [0.24984607 0.         0.         0.        ]
 [0.22389077 0.         0.         0.        ]
 [0.20075469 0.         0.         0.        ]]
2024-06-13 15:14:39,261 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:39,261 - INFO - Updated last_sequence sample during iteration: [[0.27561286 0.         0.         0.        ]
 [0.24984607 0.         0.         0.        ]
 [0.22389077 0.         0.         0.        ]
 [0.20075469 0.         0.         0.        ]
 [0.1775215  0.         0.         0.        ]]
2024-06-13 15:14:39,315 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:39,316 - INFO - Updated last_sequence sample during iteration: [[0.24984607 0.         0.         0.        ]
 [0.22389077 0.         0.         0.        ]
 [0.20075469 0.         0.         0.        ]
 [0.1775215  0.         0.         0.        ]
 [0.15689912 0.         0.         0.        ]]
2024-06-13 15:14:39,405 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:14:39,406 - INFO - Updated last_sequence sample during iteration: [[0.22389077 0.         0.         0.        ]
 [0.20075469 0.         0.         0.        ]
 [0.1775215  0.         0.         0.        ]
 [0.15689912 0.         0.         0.        ]
 [0.13659869 0.         0.         0.        ]]
2024-06-13 15:14:39,406 - INFO - Future predictions before rescaling: [0.9076019  0.9336502  0.9337595  0.9429963  0.9023103  0.8984303
 0.8489153  0.83436847 0.7841535  0.7613578  0.71350455 0.6849691
 0.64037955 0.60837096 0.56720066 0.53360903 0.4958581  0.4621701
 0.42766958 0.39499882 0.36356598 0.33269742 0.30416894 0.27561286
 0.24984607 0.22389077 0.20075469 0.1775215  0.15689912 0.13659869]
2024-06-13 15:14:39,407 - INFO - Future predictions after rescaling: [45.77181656 47.07910274 47.08458892 47.54815684 45.50624798 45.31152121
 42.82651144 42.0964506  39.57631307 38.43226342 36.03065328 34.59854586
 32.36072863 30.7543136  28.68809979 27.00223673 25.10763082 23.41693071
 21.68545362 20.04580587 18.46828605 16.91908562 15.48732669 14.05418276
 12.76102487 11.45840599 10.29727557  9.13127144  8.09629642  7.07747858]
2024-06-13 15:14:39,408 - INFO - Future predictions DataFrame:
2024-06-13 15:14:39,408 - INFO -             Future Predictions
2023-12-30           45.771817
2023-12-31           47.079103
2024-01-01           47.084589
2024-01-02           47.548157
2024-01-03           45.506248
2024-06-13 15:14:39,414 - INFO - Plotting results
2024-06-13 15:15:41,992 - INFO - Starting analysis for stock symbol: NVDA
2024-06-13 15:15:41,993 - INFO - Test ratio: 0.5, Future days: 30
2024-06-13 15:15:41,993 - INFO - Downloading stock data for NVDA
2024-06-13 15:15:42,544 - INFO - Downloaded data shape: (3522, 6)
2024-06-13 15:15:42,545 - INFO - Adding technical indicators
2024-06-13 15:15:42,547 - INFO - Technical indicators added. Updated data shape: (3473, 4)
2024-06-13 15:15:42,547 - INFO - Scaling the data
2024-06-13 15:15:42,551 - INFO - Data scaled successfully
2024-06-13 15:15:42,551 - INFO - Preparing dataset
2024-06-13 15:15:42,559 - INFO - Dataset prepared. X shape: (3413, 60, 4), y shape: (3413,)
2024-06-13 15:15:42,560 - INFO - Pre-training model on interpolation task
2024-06-13 15:16:29,786 - INFO - Loading pre-trained weights for extrapolation task
2024-06-13 15:16:30,303 - INFO - Fine-tuning model on extrapolation task
2024-06-13 15:17:47,733 - INFO - Making predictions
2024-06-13 15:17:48,713 - INFO - Rescaling predictions
2024-06-13 15:17:48,714 - INFO - Initial last_sequence shape: (60, 4)
2024-06-13 15:17:48,714 - INFO - Initial last_sequence sample: [[0.88600632 0.09536932 0.90775178 0.96101883]
 [0.90740631 0.10659768 0.90795038 0.96095939]
 [0.89766271 0.09980879 0.90804968 0.96032327]
 [0.90812362 0.08854205 0.90901967 0.9599223 ]
 [0.92820849 0.09116181 0.91040044 0.96005107]]
2024-06-13 15:17:48,789 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:48,790 - INFO - Updated last_sequence sample during iteration: [[0.97748419 0.05443941 0.99401074 0.99300907]
 [0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.85642505 0.         0.         0.        ]]
2024-06-13 15:17:48,853 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:48,853 - INFO - Updated last_sequence sample during iteration: [[0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.85642505 0.         0.         0.        ]
 [0.88753361 0.         0.         0.        ]]
2024-06-13 15:17:48,915 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:48,915 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.85642505 0.         0.         0.        ]
 [0.88753361 0.         0.         0.        ]
 [0.90951294 0.         0.         0.        ]]
2024-06-13 15:17:48,976 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:48,976 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.09422052 1.         1.        ]
 [0.85642505 0.         0.         0.        ]
 [0.88753361 0.         0.         0.        ]
 [0.90951294 0.         0.         0.        ]
 [0.96345985 0.         0.         0.        ]]
2024-06-13 15:17:49,054 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,055 - INFO - Updated last_sequence sample during iteration: [[0.85642505 0.         0.         0.        ]
 [0.88753361 0.         0.         0.        ]
 [0.90951294 0.         0.         0.        ]
 [0.96345985 0.         0.         0.        ]
 [0.91131377 0.         0.         0.        ]]
2024-06-13 15:17:49,120 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,121 - INFO - Updated last_sequence sample during iteration: [[0.88753361 0.         0.         0.        ]
 [0.90951294 0.         0.         0.        ]
 [0.96345985 0.         0.         0.        ]
 [0.91131377 0.         0.         0.        ]
 [0.93956107 0.         0.         0.        ]]
2024-06-13 15:17:49,188 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,188 - INFO - Updated last_sequence sample during iteration: [[0.90951294 0.         0.         0.        ]
 [0.96345985 0.         0.         0.        ]
 [0.91131377 0.         0.         0.        ]
 [0.93956107 0.         0.         0.        ]
 [0.88936073 0.         0.         0.        ]]
2024-06-13 15:17:49,264 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,264 - INFO - Updated last_sequence sample during iteration: [[0.96345985 0.         0.         0.        ]
 [0.91131377 0.         0.         0.        ]
 [0.93956107 0.         0.         0.        ]
 [0.88936073 0.         0.         0.        ]
 [0.89308214 0.         0.         0.        ]]
2024-06-13 15:17:49,321 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,321 - INFO - Updated last_sequence sample during iteration: [[0.91131377 0.         0.         0.        ]
 [0.93956107 0.         0.         0.        ]
 [0.88936073 0.         0.         0.        ]
 [0.89308214 0.         0.         0.        ]
 [0.84909368 0.         0.         0.        ]]
2024-06-13 15:17:49,406 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,406 - INFO - Updated last_sequence sample during iteration: [[0.93956107 0.         0.         0.        ]
 [0.88936073 0.         0.         0.        ]
 [0.89308214 0.         0.         0.        ]
 [0.84909368 0.         0.         0.        ]
 [0.836779   0.         0.         0.        ]]
2024-06-13 15:17:49,469 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,470 - INFO - Updated last_sequence sample during iteration: [[0.88936073 0.         0.         0.        ]
 [0.89308214 0.         0.         0.        ]
 [0.84909368 0.         0.         0.        ]
 [0.836779   0.         0.         0.        ]
 [0.79911643 0.         0.         0.        ]]
2024-06-13 15:17:49,545 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,546 - INFO - Updated last_sequence sample during iteration: [[0.89308214 0.         0.         0.        ]
 [0.84909368 0.         0.         0.        ]
 [0.836779   0.         0.         0.        ]
 [0.79911643 0.         0.         0.        ]
 [0.77747107 0.         0.         0.        ]]
2024-06-13 15:17:49,600 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,600 - INFO - Updated last_sequence sample during iteration: [[0.84909368 0.         0.         0.        ]
 [0.836779   0.         0.         0.        ]
 [0.79911643 0.         0.         0.        ]
 [0.77747107 0.         0.         0.        ]
 [0.7449832  0.         0.         0.        ]]
2024-06-13 15:17:49,668 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,668 - INFO - Updated last_sequence sample during iteration: [[0.836779   0.         0.         0.        ]
 [0.79911643 0.         0.         0.        ]
 [0.77747107 0.         0.         0.        ]
 [0.7449832  0.         0.         0.        ]
 [0.71829724 0.         0.         0.        ]]
2024-06-13 15:17:49,736 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,737 - INFO - Updated last_sequence sample during iteration: [[0.79911643 0.         0.         0.        ]
 [0.77747107 0.         0.         0.        ]
 [0.7449832  0.         0.         0.        ]
 [0.71829724 0.         0.         0.        ]
 [0.68976772 0.         0.         0.        ]]
2024-06-13 15:17:49,833 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,833 - INFO - Updated last_sequence sample during iteration: [[0.77747107 0.         0.         0.        ]
 [0.7449832  0.         0.         0.        ]
 [0.71829724 0.         0.         0.        ]
 [0.68976772 0.         0.         0.        ]
 [0.6609205  0.         0.         0.        ]]
2024-06-13 15:17:49,900 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,901 - INFO - Updated last_sequence sample during iteration: [[0.7449832  0.         0.         0.        ]
 [0.71829724 0.         0.         0.        ]
 [0.68976772 0.         0.         0.        ]
 [0.6609205  0.         0.         0.        ]
 [0.63536304 0.         0.         0.        ]]
2024-06-13 15:17:49,975 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:49,976 - INFO - Updated last_sequence sample during iteration: [[0.71829724 0.         0.         0.        ]
 [0.68976772 0.         0.         0.        ]
 [0.6609205  0.         0.         0.        ]
 [0.63536304 0.         0.         0.        ]
 [0.60621572 0.         0.         0.        ]]
2024-06-13 15:17:50,051 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,052 - INFO - Updated last_sequence sample during iteration: [[0.68976772 0.         0.         0.        ]
 [0.6609205  0.         0.         0.        ]
 [0.63536304 0.         0.         0.        ]
 [0.60621572 0.         0.         0.        ]
 [0.58290702 0.         0.         0.        ]]
2024-06-13 15:17:50,148 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,149 - INFO - Updated last_sequence sample during iteration: [[0.6609205  0.         0.         0.        ]
 [0.63536304 0.         0.         0.        ]
 [0.60621572 0.         0.         0.        ]
 [0.58290702 0.         0.         0.        ]
 [0.55460751 0.         0.         0.        ]]
2024-06-13 15:17:50,223 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,224 - INFO - Updated last_sequence sample during iteration: [[0.63536304 0.         0.         0.        ]
 [0.60621572 0.         0.         0.        ]
 [0.58290702 0.         0.         0.        ]
 [0.55460751 0.         0.         0.        ]
 [0.53302735 0.         0.         0.        ]]
2024-06-13 15:17:50,305 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,305 - INFO - Updated last_sequence sample during iteration: [[0.60621572 0.         0.         0.        ]
 [0.58290702 0.         0.         0.        ]
 [0.55460751 0.         0.         0.        ]
 [0.53302735 0.         0.         0.        ]
 [0.50618851 0.         0.         0.        ]]
2024-06-13 15:17:50,376 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,376 - INFO - Updated last_sequence sample during iteration: [[0.58290702 0.         0.         0.        ]
 [0.55460751 0.         0.         0.        ]
 [0.53302735 0.         0.         0.        ]
 [0.50618851 0.         0.         0.        ]
 [0.48604462 0.         0.         0.        ]]
2024-06-13 15:17:50,446 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,447 - INFO - Updated last_sequence sample during iteration: [[0.55460751 0.         0.         0.        ]
 [0.53302735 0.         0.         0.        ]
 [0.50618851 0.         0.         0.        ]
 [0.48604462 0.         0.         0.        ]
 [0.46104375 0.         0.         0.        ]]
2024-06-13 15:17:50,513 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,513 - INFO - Updated last_sequence sample during iteration: [[0.53302735 0.         0.         0.        ]
 [0.50618851 0.         0.         0.        ]
 [0.48604462 0.         0.         0.        ]
 [0.46104375 0.         0.         0.        ]
 [0.44211212 0.         0.         0.        ]]
2024-06-13 15:17:50,583 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,584 - INFO - Updated last_sequence sample during iteration: [[0.50618851 0.         0.         0.        ]
 [0.48604462 0.         0.         0.        ]
 [0.46104375 0.         0.         0.        ]
 [0.44211212 0.         0.         0.        ]
 [0.41906703 0.         0.         0.        ]]
2024-06-13 15:17:50,648 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,649 - INFO - Updated last_sequence sample during iteration: [[0.48604462 0.         0.         0.        ]
 [0.46104375 0.         0.         0.        ]
 [0.44211212 0.         0.         0.        ]
 [0.41906703 0.         0.         0.        ]
 [0.40119436 0.         0.         0.        ]]
2024-06-13 15:17:50,724 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,724 - INFO - Updated last_sequence sample during iteration: [[0.46104375 0.         0.         0.        ]
 [0.44211212 0.         0.         0.        ]
 [0.41906703 0.         0.         0.        ]
 [0.40119436 0.         0.         0.        ]
 [0.38009116 0.         0.         0.        ]]
2024-06-13 15:17:50,790 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,790 - INFO - Updated last_sequence sample during iteration: [[0.44211212 0.         0.         0.        ]
 [0.41906703 0.         0.         0.        ]
 [0.40119436 0.         0.         0.        ]
 [0.38009116 0.         0.         0.        ]
 [0.36314291 0.         0.         0.        ]]
2024-06-13 15:17:50,849 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:17:50,849 - INFO - Updated last_sequence sample during iteration: [[0.41906703 0.         0.         0.        ]
 [0.40119436 0.         0.         0.        ]
 [0.38009116 0.         0.         0.        ]
 [0.36314291 0.         0.         0.        ]
 [0.34384149 0.         0.         0.        ]]
2024-06-13 15:17:50,850 - INFO - Future predictions before rescaling: [0.85642505 0.8875336  0.90951294 0.96345985 0.9113138  0.93956107
 0.8893607  0.89308214 0.8490937  0.836779   0.79911643 0.77747107
 0.7449832  0.71829724 0.6897677  0.6609205  0.63536304 0.6062157
 0.582907   0.5546075  0.53302735 0.5061885  0.48604462 0.46104375
 0.44211212 0.41906703 0.40119436 0.38009116 0.3631429  0.3438415 ]
2024-06-13 15:17:50,850 - INFO - Future predictions after rescaling: [43.20340417 44.76464939 45.86772613 48.57515984 45.95810465 47.37575174
 44.8563471  45.04311381 42.83546464 42.21742792 40.32725672 39.24094067
 37.61047197 36.27118403 34.83937275 33.39161743 32.10896526 30.64614835
 29.4763549  28.05608735 26.97304387 25.62608305 24.61512131 23.36040263
 22.41028104 21.25371696 20.3567417  19.29763523 18.44705325 17.47837315]
2024-06-13 15:17:50,851 - INFO - Future predictions DataFrame:
2024-06-13 15:17:50,851 - INFO -             Future Predictions
2023-12-30           43.203404
2023-12-31           44.764649
2024-01-01           45.867726
2024-01-02           48.575160
2024-01-03           45.958105
2024-06-13 15:17:50,857 - INFO - Plotting results
2024-06-13 15:21:27,706 - INFO - Starting analysis for stock symbol: NVDA
2024-06-13 15:21:27,706 - INFO - Test ratio: 1.0, Future days: 30
2024-06-13 15:21:27,706 - INFO - Downloading stock data for NVDA
2024-06-13 15:21:28,186 - INFO - Downloaded data shape: (3522, 6)
2024-06-13 15:21:28,187 - INFO - Adding technical indicators
2024-06-13 15:21:28,189 - INFO - Technical indicators added. Updated data shape: (3473, 4)
2024-06-13 15:21:28,189 - INFO - Scaling the data
2024-06-13 15:21:28,193 - INFO - Data scaled successfully
2024-06-13 15:21:28,193 - INFO - Preparing dataset
2024-06-13 15:21:28,200 - INFO - Dataset prepared. X shape: (3413, 60, 4), y shape: (3413,)
2024-06-13 15:21:28,200 - INFO - Pre-training model on interpolation task
2024-06-13 15:22:12,896 - INFO - Loading pre-trained weights for extrapolation task
2024-06-13 15:22:13,378 - INFO - Fine-tuning model on extrapolation task
2024-06-13 15:23:36,344 - INFO - Making predictions
2024-06-13 15:23:37,342 - INFO - Rescaling predictions
2024-06-13 15:23:37,342 - INFO - Initial last_sequence shape: (60, 4)
2024-06-13 15:23:37,343 - INFO - Initial last_sequence sample: [[0.88600632 0.09536932 0.90775178 0.96101883]
 [0.90740631 0.10659768 0.90795038 0.96095939]
 [0.89766271 0.09980879 0.90804968 0.96032327]
 [0.90812362 0.08854205 0.90901967 0.9599223 ]
 [0.92820849 0.09116181 0.91040044 0.96005107]]
2024-06-13 15:23:37,409 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,410 - INFO - Updated last_sequence sample during iteration: [[0.97748419 0.05443941 0.99401074 0.99300907]
 [0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.88873309 0.         0.         0.        ]]
2024-06-13 15:23:37,468 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,469 - INFO - Updated last_sequence sample during iteration: [[0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.88873309 0.         0.         0.        ]
 [0.91554517 0.         0.         0.        ]]
2024-06-13 15:23:37,539 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,540 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.88873309 0.         0.         0.        ]
 [0.91554517 0.         0.         0.        ]
 [0.8849709  0.         0.         0.        ]]
2024-06-13 15:23:37,626 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,627 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.09422052 1.         1.        ]
 [0.88873309 0.         0.         0.        ]
 [0.91554517 0.         0.         0.        ]
 [0.8849709  0.         0.         0.        ]
 [0.95439446 0.         0.         0.        ]]
2024-06-13 15:23:37,701 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,702 - INFO - Updated last_sequence sample during iteration: [[0.88873309 0.         0.         0.        ]
 [0.91554517 0.         0.         0.        ]
 [0.8849709  0.         0.         0.        ]
 [0.95439446 0.         0.         0.        ]
 [0.90985233 0.         0.         0.        ]]
2024-06-13 15:23:37,776 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,777 - INFO - Updated last_sequence sample during iteration: [[0.91554517 0.         0.         0.        ]
 [0.8849709  0.         0.         0.        ]
 [0.95439446 0.         0.         0.        ]
 [0.90985233 0.         0.         0.        ]
 [0.9641071  0.         0.         0.        ]]
2024-06-13 15:23:37,851 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,851 - INFO - Updated last_sequence sample during iteration: [[0.8849709  0.         0.         0.        ]
 [0.95439446 0.         0.         0.        ]
 [0.90985233 0.         0.         0.        ]
 [0.9641071  0.         0.         0.        ]
 [0.93179071 0.         0.         0.        ]]
2024-06-13 15:23:37,910 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,911 - INFO - Updated last_sequence sample during iteration: [[0.95439446 0.         0.         0.        ]
 [0.90985233 0.         0.         0.        ]
 [0.9641071  0.         0.         0.        ]
 [0.93179071 0.         0.         0.        ]
 [0.96349013 0.         0.         0.        ]]
2024-06-13 15:23:37,987 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:37,987 - INFO - Updated last_sequence sample during iteration: [[0.90985233 0.         0.         0.        ]
 [0.9641071  0.         0.         0.        ]
 [0.93179071 0.         0.         0.        ]
 [0.96349013 0.         0.         0.        ]
 [0.94253725 0.         0.         0.        ]]
2024-06-13 15:23:38,062 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,063 - INFO - Updated last_sequence sample during iteration: [[0.9641071  0.         0.         0.        ]
 [0.93179071 0.         0.         0.        ]
 [0.96349013 0.         0.         0.        ]
 [0.94253725 0.         0.         0.        ]
 [0.95500404 0.         0.         0.        ]]
2024-06-13 15:23:38,125 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,126 - INFO - Updated last_sequence sample during iteration: [[0.93179071 0.         0.         0.        ]
 [0.96349013 0.         0.         0.        ]
 [0.94253725 0.         0.         0.        ]
 [0.95500404 0.         0.         0.        ]
 [0.94072765 0.         0.         0.        ]]
2024-06-13 15:23:38,191 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,191 - INFO - Updated last_sequence sample during iteration: [[0.96349013 0.         0.         0.        ]
 [0.94253725 0.         0.         0.        ]
 [0.95500404 0.         0.         0.        ]
 [0.94072765 0.         0.         0.        ]
 [0.94055152 0.         0.         0.        ]]
2024-06-13 15:23:38,430 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,431 - INFO - Updated last_sequence sample during iteration: [[0.94253725 0.         0.         0.        ]
 [0.95500404 0.         0.         0.        ]
 [0.94072765 0.         0.         0.        ]
 [0.94055152 0.         0.         0.        ]
 [0.92847914 0.         0.         0.        ]]
2024-06-13 15:23:38,489 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,490 - INFO - Updated last_sequence sample during iteration: [[0.95500404 0.         0.         0.        ]
 [0.94072765 0.         0.         0.        ]
 [0.94055152 0.         0.         0.        ]
 [0.92847914 0.         0.         0.        ]
 [0.9217214  0.         0.         0.        ]]
2024-06-13 15:23:38,547 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,547 - INFO - Updated last_sequence sample during iteration: [[0.94072765 0.         0.         0.        ]
 [0.94055152 0.         0.         0.        ]
 [0.92847914 0.         0.         0.        ]
 [0.9217214  0.         0.         0.        ]
 [0.90998769 0.         0.         0.        ]]
2024-06-13 15:23:38,605 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,606 - INFO - Updated last_sequence sample during iteration: [[0.94055152 0.         0.         0.        ]
 [0.92847914 0.         0.         0.        ]
 [0.9217214  0.         0.         0.        ]
 [0.90998769 0.         0.         0.        ]
 [0.89969951 0.         0.         0.        ]]
2024-06-13 15:23:38,675 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,675 - INFO - Updated last_sequence sample during iteration: [[0.92847914 0.         0.         0.        ]
 [0.9217214  0.         0.         0.        ]
 [0.90998769 0.         0.         0.        ]
 [0.89969951 0.         0.         0.        ]
 [0.88784111 0.         0.         0.        ]]
2024-06-13 15:23:38,741 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,742 - INFO - Updated last_sequence sample during iteration: [[0.9217214  0.         0.         0.        ]
 [0.90998769 0.         0.         0.        ]
 [0.89969951 0.         0.         0.        ]
 [0.88784111 0.         0.         0.        ]
 [0.87562603 0.         0.         0.        ]]
2024-06-13 15:23:38,817 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,818 - INFO - Updated last_sequence sample during iteration: [[0.90998769 0.         0.         0.        ]
 [0.89969951 0.         0.         0.        ]
 [0.88784111 0.         0.         0.        ]
 [0.87562603 0.         0.         0.        ]
 [0.86361229 0.         0.         0.        ]]
2024-06-13 15:23:38,874 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,874 - INFO - Updated last_sequence sample during iteration: [[0.89969951 0.         0.         0.        ]
 [0.88784111 0.         0.         0.        ]
 [0.87562603 0.         0.         0.        ]
 [0.86361229 0.         0.         0.        ]
 [0.85049874 0.         0.         0.        ]]
2024-06-13 15:23:38,943 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:38,944 - INFO - Updated last_sequence sample during iteration: [[0.88784111 0.         0.         0.        ]
 [0.87562603 0.         0.         0.        ]
 [0.86361229 0.         0.         0.        ]
 [0.85049874 0.         0.         0.        ]
 [0.83845127 0.         0.         0.        ]]
2024-06-13 15:23:39,018 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,019 - INFO - Updated last_sequence sample during iteration: [[0.87562603 0.         0.         0.        ]
 [0.86361229 0.         0.         0.        ]
 [0.85049874 0.         0.         0.        ]
 [0.83845127 0.         0.         0.        ]
 [0.82512218 0.         0.         0.        ]]
2024-06-13 15:23:39,098 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,099 - INFO - Updated last_sequence sample during iteration: [[0.86361229 0.         0.         0.        ]
 [0.85049874 0.         0.         0.        ]
 [0.83845127 0.         0.         0.        ]
 [0.82512218 0.         0.         0.        ]
 [0.81319672 0.         0.         0.        ]]
2024-06-13 15:23:39,178 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,178 - INFO - Updated last_sequence sample during iteration: [[0.85049874 0.         0.         0.        ]
 [0.83845127 0.         0.         0.        ]
 [0.82512218 0.         0.         0.        ]
 [0.81319672 0.         0.         0.        ]
 [0.80009902 0.         0.         0.        ]]
2024-06-13 15:23:39,234 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,234 - INFO - Updated last_sequence sample during iteration: [[0.83845127 0.         0.         0.        ]
 [0.82512218 0.         0.         0.        ]
 [0.81319672 0.         0.         0.        ]
 [0.80009902 0.         0.         0.        ]
 [0.78844565 0.         0.         0.        ]]
2024-06-13 15:23:39,304 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,305 - INFO - Updated last_sequence sample during iteration: [[0.82512218 0.         0.         0.        ]
 [0.81319672 0.         0.         0.        ]
 [0.80009902 0.         0.         0.        ]
 [0.78844565 0.         0.         0.        ]
 [0.7758615  0.         0.         0.        ]]
2024-06-13 15:23:39,366 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,367 - INFO - Updated last_sequence sample during iteration: [[0.81319672 0.         0.         0.        ]
 [0.80009902 0.         0.         0.        ]
 [0.78844565 0.         0.         0.        ]
 [0.7758615  0.         0.         0.        ]
 [0.76460439 0.         0.         0.        ]]
2024-06-13 15:23:39,449 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,450 - INFO - Updated last_sequence sample during iteration: [[0.80009902 0.         0.         0.        ]
 [0.78844565 0.         0.         0.        ]
 [0.7758615  0.         0.         0.        ]
 [0.76460439 0.         0.         0.        ]
 [0.75269777 0.         0.         0.        ]]
2024-06-13 15:23:39,514 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,514 - INFO - Updated last_sequence sample during iteration: [[0.78844565 0.         0.         0.        ]
 [0.7758615  0.         0.         0.        ]
 [0.76460439 0.         0.         0.        ]
 [0.75269777 0.         0.         0.        ]
 [0.74193174 0.         0.         0.        ]]
2024-06-13 15:23:39,582 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:23:39,583 - INFO - Updated last_sequence sample during iteration: [[0.7758615  0.         0.         0.        ]
 [0.76460439 0.         0.         0.        ]
 [0.75269777 0.         0.         0.        ]
 [0.74193174 0.         0.         0.        ]
 [0.73078585 0.         0.         0.        ]]
2024-06-13 15:23:39,583 - INFO - Future predictions before rescaling: [0.8887331  0.91554517 0.8849709  0.95439446 0.9098523  0.9641071
 0.9317907  0.9634901  0.94253725 0.95500404 0.94072765 0.9405515
 0.92847914 0.9217214  0.9099877  0.8996995  0.8878411  0.875626
 0.8636123  0.85049874 0.83845127 0.8251222  0.8131967  0.800099
 0.78844565 0.7758615  0.7646044  0.75269777 0.74193174 0.73078585]
2024-06-13 15:23:39,584 - INFO - Future predictions after rescaling: [44.82484789 46.17046559 44.63603508 48.12019513 45.88475904 48.60764322
 46.98578071 48.57667946 47.52511725 48.15078796 47.434299   47.42545948
 46.81958272 46.48043221 45.89155246 45.37521962 44.78008191 44.16704379
 43.56411055 42.9059804  42.30135403 41.63240706 41.03390404 40.3765696
 39.79172223 39.16016149 38.59520081 37.99764307 37.45732835 36.89794958]
2024-06-13 15:23:39,585 - INFO - Future predictions DataFrame:
2024-06-13 15:23:39,585 - INFO -             Future Predictions
2023-12-30           44.824848
2023-12-31           46.170466
2024-01-01           44.636035
2024-01-02           48.120195
2024-01-03           45.884759
2024-06-13 15:23:39,589 - INFO - Plotting results
2024-06-13 15:31:11,774 - INFO - Starting analysis for stock symbol: NVDA
2024-06-13 15:31:11,774 - INFO - Test ratio: 0.2, Future days: 30
2024-06-13 15:31:11,774 - INFO - Downloading stock data for NVDA
2024-06-13 15:31:12,295 - INFO - Downloaded data shape: (3522, 6)
2024-06-13 15:31:12,297 - INFO - Adding technical indicators
2024-06-13 15:31:12,301 - INFO - Technical indicators added. Updated data shape: (3473, 4)
2024-06-13 15:31:12,301 - INFO - Scaling the data
2024-06-13 15:31:12,305 - INFO - Data scaled successfully
2024-06-13 15:31:12,305 - INFO - Preparing dataset
2024-06-13 15:31:12,314 - INFO - Dataset prepared. X shape: (3413, 60, 4), y shape: (3413,)
2024-06-13 15:31:12,315 - INFO - Pre-training model on interpolation task
2024-06-13 15:32:22,846 - INFO - Loading pre-trained weights for extrapolation task
2024-06-13 15:32:23,342 - INFO - Fine-tuning model on extrapolation task
2024-06-13 15:33:34,864 - INFO - Making predictions
2024-06-13 15:33:35,794 - INFO - Rescaling predictions
2024-06-13 15:33:35,795 - INFO - Initial last_sequence shape: (60, 4)
2024-06-13 15:33:35,796 - INFO - Initial last_sequence sample: [[0.88600632 0.09536932 0.90775178 0.96101883]
 [0.90740631 0.10659768 0.90795038 0.96095939]
 [0.89766271 0.09980879 0.90804968 0.96032327]
 [0.90812362 0.08854205 0.90901967 0.9599223 ]
 [0.92820849 0.09116181 0.91040044 0.96005107]]
2024-06-13 15:33:35,889 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:35,890 - INFO - Updated last_sequence sample during iteration: [[0.97748419 0.05443941 0.99401074 0.99300907]
 [0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.89870107 0.         0.         0.        ]]
2024-06-13 15:33:35,958 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:35,959 - INFO - Updated last_sequence sample during iteration: [[0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.89870107 0.         0.         0.        ]
 [0.92561424 0.         0.         0.        ]]
2024-06-13 15:33:36,026 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,026 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.89870107 0.         0.         0.        ]
 [0.92561424 0.         0.         0.        ]
 [0.94474137 0.         0.         0.        ]]
2024-06-13 15:33:36,100 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,101 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.09422052 1.         1.        ]
 [0.89870107 0.         0.         0.        ]
 [0.92561424 0.         0.         0.        ]
 [0.94474137 0.         0.         0.        ]
 [0.99951494 0.         0.         0.        ]]
2024-06-13 15:33:36,174 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,174 - INFO - Updated last_sequence sample during iteration: [[0.89870107 0.         0.         0.        ]
 [0.92561424 0.         0.         0.        ]
 [0.94474137 0.         0.         0.        ]
 [0.99951494 0.         0.         0.        ]
 [0.97524977 0.         0.         0.        ]]
2024-06-13 15:33:36,263 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,263 - INFO - Updated last_sequence sample during iteration: [[0.92561424 0.         0.         0.        ]
 [0.94474137 0.         0.         0.        ]
 [0.99951494 0.         0.         0.        ]
 [0.97524977 0.         0.         0.        ]
 [1.00759363 0.         0.         0.        ]]
2024-06-13 15:33:36,341 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,342 - INFO - Updated last_sequence sample during iteration: [[0.94474137 0.         0.         0.        ]
 [0.99951494 0.         0.         0.        ]
 [0.97524977 0.         0.         0.        ]
 [1.00759363 0.         0.         0.        ]
 [0.98194659 0.         0.         0.        ]]
2024-06-13 15:33:36,421 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,423 - INFO - Updated last_sequence sample during iteration: [[0.99951494 0.         0.         0.        ]
 [0.97524977 0.         0.         0.        ]
 [1.00759363 0.         0.         0.        ]
 [0.98194659 0.         0.         0.        ]
 [0.99342954 0.         0.         0.        ]]
2024-06-13 15:33:36,492 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,493 - INFO - Updated last_sequence sample during iteration: [[0.97524977 0.         0.         0.        ]
 [1.00759363 0.         0.         0.        ]
 [0.98194659 0.         0.         0.        ]
 [0.99342954 0.         0.         0.        ]
 [0.96965492 0.         0.         0.        ]]
2024-06-13 15:33:36,581 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,582 - INFO - Updated last_sequence sample during iteration: [[1.00759363 0.         0.         0.        ]
 [0.98194659 0.         0.         0.        ]
 [0.99342954 0.         0.         0.        ]
 [0.96965492 0.         0.         0.        ]
 [0.96789026 0.         0.         0.        ]]
2024-06-13 15:33:36,650 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,651 - INFO - Updated last_sequence sample during iteration: [[0.98194659 0.         0.         0.        ]
 [0.99342954 0.         0.         0.        ]
 [0.96965492 0.         0.         0.        ]
 [0.96789026 0.         0.         0.        ]
 [0.94590688 0.         0.         0.        ]]
2024-06-13 15:33:36,726 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,727 - INFO - Updated last_sequence sample during iteration: [[0.99342954 0.         0.         0.        ]
 [0.96965492 0.         0.         0.        ]
 [0.96789026 0.         0.         0.        ]
 [0.94590688 0.         0.         0.        ]
 [0.93685722 0.         0.         0.        ]]
2024-06-13 15:33:36,796 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,796 - INFO - Updated last_sequence sample during iteration: [[0.96965492 0.         0.         0.        ]
 [0.96789026 0.         0.         0.        ]
 [0.94590688 0.         0.         0.        ]
 [0.93685722 0.         0.         0.        ]
 [0.91657293 0.         0.         0.        ]]
2024-06-13 15:33:36,866 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,866 - INFO - Updated last_sequence sample during iteration: [[0.96789026 0.         0.         0.        ]
 [0.94590688 0.         0.         0.        ]
 [0.93685722 0.         0.         0.        ]
 [0.91657293 0.         0.         0.        ]
 [0.90354252 0.         0.         0.        ]]
2024-06-13 15:33:36,925 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,926 - INFO - Updated last_sequence sample during iteration: [[0.94590688 0.         0.         0.        ]
 [0.93685722 0.         0.         0.        ]
 [0.91657293 0.         0.         0.        ]
 [0.90354252 0.         0.         0.        ]
 [0.88476121 0.         0.         0.        ]]
2024-06-13 15:33:36,990 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:36,991 - INFO - Updated last_sequence sample during iteration: [[0.93685722 0.         0.         0.        ]
 [0.91657293 0.         0.         0.        ]
 [0.90354252 0.         0.         0.        ]
 [0.88476121 0.         0.         0.        ]
 [0.86985373 0.         0.         0.        ]]
2024-06-13 15:33:37,086 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,087 - INFO - Updated last_sequence sample during iteration: [[0.91657293 0.         0.         0.        ]
 [0.90354252 0.         0.         0.        ]
 [0.88476121 0.         0.         0.        ]
 [0.86985373 0.         0.         0.        ]
 [0.85242021 0.         0.         0.        ]]
2024-06-13 15:33:37,173 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,174 - INFO - Updated last_sequence sample during iteration: [[0.90354252 0.         0.         0.        ]
 [0.88476121 0.         0.         0.        ]
 [0.86985373 0.         0.         0.        ]
 [0.85242021 0.         0.         0.        ]
 [0.83693635 0.         0.         0.        ]]
2024-06-13 15:33:37,248 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,249 - INFO - Updated last_sequence sample during iteration: [[0.88476121 0.         0.         0.        ]
 [0.86985373 0.         0.         0.        ]
 [0.85242021 0.         0.         0.        ]
 [0.83693635 0.         0.         0.        ]
 [0.82074034 0.         0.         0.        ]]
2024-06-13 15:33:37,316 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,317 - INFO - Updated last_sequence sample during iteration: [[0.86985373 0.         0.         0.        ]
 [0.85242021 0.         0.         0.        ]
 [0.83693635 0.         0.         0.        ]
 [0.82074034 0.         0.         0.        ]
 [0.80546296 0.         0.         0.        ]]
2024-06-13 15:33:37,379 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,380 - INFO - Updated last_sequence sample during iteration: [[0.85242021 0.         0.         0.        ]
 [0.83693635 0.         0.         0.        ]
 [0.82074034 0.         0.         0.        ]
 [0.80546296 0.         0.         0.        ]
 [0.79042327 0.         0.         0.        ]]
2024-06-13 15:33:37,435 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,436 - INFO - Updated last_sequence sample during iteration: [[0.83693635 0.         0.         0.        ]
 [0.82074034 0.         0.         0.        ]
 [0.80546296 0.         0.         0.        ]
 [0.79042327 0.         0.         0.        ]
 [0.77579975 0.         0.         0.        ]]
2024-06-13 15:33:37,519 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,520 - INFO - Updated last_sequence sample during iteration: [[0.82074034 0.         0.         0.        ]
 [0.80546296 0.         0.         0.        ]
 [0.79042327 0.         0.         0.        ]
 [0.77579975 0.         0.         0.        ]
 [0.76184857 0.         0.         0.        ]]
2024-06-13 15:33:37,588 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,589 - INFO - Updated last_sequence sample during iteration: [[0.80546296 0.         0.         0.        ]
 [0.79042327 0.         0.         0.        ]
 [0.77579975 0.         0.         0.        ]
 [0.76184857 0.         0.         0.        ]
 [0.74810958 0.         0.         0.        ]]
2024-06-13 15:33:37,655 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,656 - INFO - Updated last_sequence sample during iteration: [[0.79042327 0.         0.         0.        ]
 [0.77579975 0.         0.         0.        ]
 [0.76184857 0.         0.         0.        ]
 [0.74810958 0.         0.         0.        ]
 [0.73518515 0.         0.         0.        ]]
2024-06-13 15:33:37,724 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,725 - INFO - Updated last_sequence sample during iteration: [[0.77579975 0.         0.         0.        ]
 [0.76184857 0.         0.         0.        ]
 [0.74810958 0.         0.         0.        ]
 [0.73518515 0.         0.         0.        ]
 [0.72242415 0.         0.         0.        ]]
2024-06-13 15:33:37,810 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,811 - INFO - Updated last_sequence sample during iteration: [[0.76184857 0.         0.         0.        ]
 [0.74810958 0.         0.         0.        ]
 [0.73518515 0.         0.         0.        ]
 [0.72242415 0.         0.         0.        ]
 [0.71046567 0.         0.         0.        ]]
2024-06-13 15:33:37,875 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,876 - INFO - Updated last_sequence sample during iteration: [[0.74810958 0.         0.         0.        ]
 [0.73518515 0.         0.         0.        ]
 [0.72242415 0.         0.         0.        ]
 [0.71046567 0.         0.         0.        ]
 [0.69869244 0.         0.         0.        ]]
2024-06-13 15:33:37,949 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:37,950 - INFO - Updated last_sequence sample during iteration: [[0.73518515 0.         0.         0.        ]
 [0.72242415 0.         0.         0.        ]
 [0.71046567 0.         0.         0.        ]
 [0.69869244 0.         0.         0.        ]
 [0.68763745 0.         0.         0.        ]]
2024-06-13 15:33:38,031 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-13 15:33:38,031 - INFO - Updated last_sequence sample during iteration: [[0.72242415 0.         0.         0.        ]
 [0.71046567 0.         0.         0.        ]
 [0.69869244 0.         0.         0.        ]
 [0.68763745 0.         0.         0.        ]
 [0.67681277 0.         0.         0.        ]]
2024-06-13 15:33:38,032 - INFO - Future predictions before rescaling: [0.8987011  0.92561424 0.94474137 0.99951494 0.97524977 1.0075936
 0.9819466  0.99342954 0.9696549  0.96789026 0.9459069  0.9368572
 0.9165729  0.9035425  0.8847612  0.86985373 0.8524202  0.83693635
 0.82074034 0.80546296 0.7904233  0.77579975 0.76184857 0.7481096
 0.73518515 0.72242415 0.71046567 0.69869244 0.68763745 0.67681277]
2024-06-13 15:33:38,032 - INFO - Future predictions after rescaling: [45.32511104 46.67580212 47.63573543 50.38465656 49.16686046 50.790102
 49.50295378 50.0792488  48.88607174 48.79750899 47.69422884 47.24005385
 46.22204592 45.56808874 44.62551141 43.87734974 43.00241346 42.22532516
 41.41249588 40.64576971 39.89097317 39.15706243 38.45689443 37.76737574
 37.11873723 36.47830108 35.87814084 35.28727781 34.73246089 34.18920266]
2024-06-13 15:33:38,033 - INFO - Future predictions DataFrame:
2024-06-13 15:33:38,033 - INFO -             Future Predictions
2023-12-30           45.325111
2023-12-31           46.675802
2024-01-01           47.635735
2024-01-02           50.384657
2024-01-03           49.166860
2024-06-13 15:33:38,042 - INFO - Plotting results
2024-06-14 08:01:06,134 - INFO - Starting analysis for stock symbol: NVDA
2024-06-14 08:01:06,135 - INFO - Test ratio: 0.2, Future days: 30
2024-06-14 08:01:06,135 - INFO - Downloading stock data for NVDA
2024-06-14 08:01:09,920 - INFO - Downloaded data shape: (3522, 6)
2024-06-14 08:01:09,921 - INFO - Adding technical indicators
2024-06-14 08:01:09,926 - INFO - Technical indicators added. Updated data shape: (3473, 4)
2024-06-14 08:01:09,926 - INFO - Scaling the data
2024-06-14 08:01:09,930 - INFO - Data scaled successfully
2024-06-14 08:01:09,930 - INFO - Preparing dataset
2024-06-14 08:01:09,938 - INFO - Dataset prepared. X shape: (3413, 60, 4), y shape: (3413,)
2024-06-14 08:01:09,938 - INFO - Pre-training model on interpolation task
2024-06-14 08:02:15,570 - INFO - Loading pre-trained weights for extrapolation task
2024-06-14 08:04:49,001 - INFO - Starting analysis for stock symbol: NVDA
2024-06-14 08:04:49,001 - INFO - Test ratio: 0.2, Future days: 30
2024-06-14 08:04:49,001 - INFO - Downloading stock data for NVDA
2024-06-14 08:04:49,456 - INFO - Downloaded data shape: (3522, 6)
2024-06-14 08:04:49,457 - INFO - Adding technical indicators
2024-06-14 08:04:49,459 - INFO - Technical indicators added. Updated data shape: (3473, 4)
2024-06-14 08:04:49,459 - INFO - Scaling the data
2024-06-14 08:04:49,461 - INFO - Data scaled successfully
2024-06-14 08:04:49,461 - INFO - Preparing dataset
2024-06-14 08:04:49,469 - INFO - Dataset prepared. X shape: (3413, 60, 4), y shape: (3413,)
2024-06-14 08:04:49,469 - INFO - Pre-training model on interpolation task
2024-06-14 08:06:12,377 - INFO - Loading pre-trained weights for extrapolation task
2024-06-14 08:06:12,914 - INFO - Fine-tuning model on extrapolation task
2024-06-14 08:07:59,969 - INFO - Making predictions
2024-06-14 08:08:01,021 - INFO - Rescaling predictions
2024-06-14 08:08:01,022 - INFO - Initial last_sequence shape: (60, 4)
2024-06-14 08:08:01,023 - INFO - Initial last_sequence sample: [[0.88600632 0.09536932 0.90775178 0.96101883]
 [0.90740631 0.10659768 0.90795038 0.96095939]
 [0.89766271 0.09980879 0.90804968 0.96032327]
 [0.90812362 0.08854205 0.90901967 0.9599223 ]
 [0.92820849 0.09116181 0.91040044 0.96005107]]
2024-06-14 08:08:01,112 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,112 - INFO - Updated last_sequence sample during iteration: [[0.97748419 0.05443941 0.99401074 0.99300907]
 [0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86512798 0.         0.         0.        ]]
2024-06-14 08:08:01,181 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,181 - INFO - Updated last_sequence sample during iteration: [[0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86512798 0.         0.         0.        ]
 [0.91336453 0.         0.         0.        ]]
2024-06-14 08:08:01,259 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,260 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86512798 0.         0.         0.        ]
 [0.91336453 0.         0.         0.        ]
 [0.93085766 0.         0.         0.        ]]
2024-06-14 08:08:01,325 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,326 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.09422052 1.         1.        ]
 [0.86512798 0.         0.         0.        ]
 [0.91336453 0.         0.         0.        ]
 [0.93085766 0.         0.         0.        ]
 [0.94685596 0.         0.         0.        ]]
2024-06-14 08:08:01,383 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,383 - INFO - Updated last_sequence sample during iteration: [[0.86512798 0.         0.         0.        ]
 [0.91336453 0.         0.         0.        ]
 [0.93085766 0.         0.         0.        ]
 [0.94685596 0.         0.         0.        ]
 [0.85465747 0.         0.         0.        ]]
2024-06-14 08:08:01,451 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,452 - INFO - Updated last_sequence sample during iteration: [[0.91336453 0.         0.         0.        ]
 [0.93085766 0.         0.         0.        ]
 [0.94685596 0.         0.         0.        ]
 [0.85465747 0.         0.         0.        ]
 [0.84482306 0.         0.         0.        ]]
2024-06-14 08:08:01,537 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,538 - INFO - Updated last_sequence sample during iteration: [[0.93085766 0.         0.         0.        ]
 [0.94685596 0.         0.         0.        ]
 [0.85465747 0.         0.         0.        ]
 [0.84482306 0.         0.         0.        ]
 [0.76168823 0.         0.         0.        ]]
2024-06-14 08:08:01,608 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,609 - INFO - Updated last_sequence sample during iteration: [[0.94685596 0.         0.         0.        ]
 [0.85465747 0.         0.         0.        ]
 [0.84482306 0.         0.         0.        ]
 [0.76168823 0.         0.         0.        ]
 [0.73106158 0.         0.         0.        ]]
2024-06-14 08:08:01,682 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,683 - INFO - Updated last_sequence sample during iteration: [[0.85465747 0.         0.         0.        ]
 [0.84482306 0.         0.         0.        ]
 [0.76168823 0.         0.         0.        ]
 [0.73106158 0.         0.         0.        ]
 [0.65927553 0.         0.         0.        ]]
2024-06-14 08:08:01,766 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,767 - INFO - Updated last_sequence sample during iteration: [[0.84482306 0.         0.         0.        ]
 [0.76168823 0.         0.         0.        ]
 [0.73106158 0.         0.         0.        ]
 [0.65927553 0.         0.         0.        ]
 [0.61661237 0.         0.         0.        ]]
2024-06-14 08:08:01,837 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,837 - INFO - Updated last_sequence sample during iteration: [[0.76168823 0.         0.         0.        ]
 [0.73106158 0.         0.         0.        ]
 [0.65927553 0.         0.         0.        ]
 [0.61661237 0.         0.         0.        ]
 [0.55831826 0.         0.         0.        ]]
2024-06-14 08:08:01,910 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:01,911 - INFO - Updated last_sequence sample during iteration: [[0.73106158 0.         0.         0.        ]
 [0.65927553 0.         0.         0.        ]
 [0.61661237 0.         0.         0.        ]
 [0.55831826 0.         0.         0.        ]
 [0.5101397  0.         0.         0.        ]]
2024-06-14 08:08:01,999 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,000 - INFO - Updated last_sequence sample during iteration: [[0.65927553 0.         0.         0.        ]
 [0.61661237 0.         0.         0.        ]
 [0.55831826 0.         0.         0.        ]
 [0.5101397  0.         0.         0.        ]
 [0.46323895 0.         0.         0.        ]]
2024-06-14 08:08:02,068 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,068 - INFO - Updated last_sequence sample during iteration: [[0.61661237 0.         0.         0.        ]
 [0.55831826 0.         0.         0.        ]
 [0.5101397  0.         0.         0.        ]
 [0.46323895 0.         0.         0.        ]
 [0.41433179 0.         0.         0.        ]]
2024-06-14 08:08:02,139 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,139 - INFO - Updated last_sequence sample during iteration: [[0.55831826 0.         0.         0.        ]
 [0.5101397  0.         0.         0.        ]
 [0.46323895 0.         0.         0.        ]
 [0.41433179 0.         0.         0.        ]
 [0.37635911 0.         0.         0.        ]]
2024-06-14 08:08:02,214 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,215 - INFO - Updated last_sequence sample during iteration: [[0.5101397  0.         0.         0.        ]
 [0.46323895 0.         0.         0.        ]
 [0.41433179 0.         0.         0.        ]
 [0.37635911 0.         0.         0.        ]
 [0.32983392 0.         0.         0.        ]]
2024-06-14 08:08:02,284 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,284 - INFO - Updated last_sequence sample during iteration: [[0.46323895 0.         0.         0.        ]
 [0.41433179 0.         0.         0.        ]
 [0.37635911 0.         0.         0.        ]
 [0.32983392 0.         0.         0.        ]
 [0.29866374 0.         0.         0.        ]]
2024-06-14 08:08:02,348 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,348 - INFO - Updated last_sequence sample during iteration: [[0.41433179 0.         0.         0.        ]
 [0.37635911 0.         0.         0.        ]
 [0.32983392 0.         0.         0.        ]
 [0.29866374 0.         0.         0.        ]
 [0.25633004 0.         0.         0.        ]]
2024-06-14 08:08:02,414 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,414 - INFO - Updated last_sequence sample during iteration: [[0.37635911 0.         0.         0.        ]
 [0.32983392 0.         0.         0.        ]
 [0.29866374 0.         0.         0.        ]
 [0.25633004 0.         0.         0.        ]
 [0.2302324  0.         0.         0.        ]]
2024-06-14 08:08:02,501 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,501 - INFO - Updated last_sequence sample during iteration: [[0.32983392 0.         0.         0.        ]
 [0.29866374 0.         0.         0.        ]
 [0.25633004 0.         0.         0.        ]
 [0.2302324  0.         0.         0.        ]
 [0.19287443 0.         0.         0.        ]]
2024-06-14 08:08:02,570 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,571 - INFO - Updated last_sequence sample during iteration: [[0.29866374 0.         0.         0.        ]
 [0.25633004 0.         0.         0.        ]
 [0.2302324  0.         0.         0.        ]
 [0.19287443 0.         0.         0.        ]
 [0.17068622 0.         0.         0.        ]]
2024-06-14 08:08:02,633 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,634 - INFO - Updated last_sequence sample during iteration: [[0.25633004 0.         0.         0.        ]
 [0.2302324  0.         0.         0.        ]
 [0.19287443 0.         0.         0.        ]
 [0.17068622 0.         0.         0.        ]
 [0.13858911 0.         0.         0.        ]]
2024-06-14 08:08:02,703 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,703 - INFO - Updated last_sequence sample during iteration: [[0.2302324  0.         0.         0.        ]
 [0.19287443 0.         0.         0.        ]
 [0.17068622 0.         0.         0.        ]
 [0.13858911 0.         0.         0.        ]
 [0.12000051 0.         0.         0.        ]]
2024-06-14 08:08:02,781 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,782 - INFO - Updated last_sequence sample during iteration: [[0.19287443 0.         0.         0.        ]
 [0.17068622 0.         0.         0.        ]
 [0.13858911 0.         0.         0.        ]
 [0.12000051 0.         0.         0.        ]
 [0.09411278 0.         0.         0.        ]]
2024-06-14 08:08:02,867 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,867 - INFO - Updated last_sequence sample during iteration: [[0.17068622 0.         0.         0.        ]
 [0.13858911 0.         0.         0.        ]
 [0.12000051 0.         0.         0.        ]
 [0.09411278 0.         0.         0.        ]
 [0.07963851 0.         0.         0.        ]]
2024-06-14 08:08:02,941 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:02,941 - INFO - Updated last_sequence sample during iteration: [[0.13858911 0.         0.         0.        ]
 [0.12000051 0.         0.         0.        ]
 [0.09411278 0.         0.         0.        ]
 [0.07963851 0.         0.         0.        ]
 [0.06025839 0.         0.         0.        ]]
2024-06-14 08:08:03,004 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:03,005 - INFO - Updated last_sequence sample during iteration: [[0.12000051 0.         0.         0.        ]
 [0.09411278 0.         0.         0.        ]
 [0.07963851 0.         0.         0.        ]
 [0.06025839 0.         0.         0.        ]
 [0.04935845 0.         0.         0.        ]]
2024-06-14 08:08:03,100 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:03,100 - INFO - Updated last_sequence sample during iteration: [[0.09411278 0.         0.         0.        ]
 [0.07963851 0.         0.         0.        ]
 [0.06025839 0.         0.         0.        ]
 [0.04935845 0.         0.         0.        ]
 [0.03581793 0.         0.         0.        ]]
2024-06-14 08:08:03,164 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:03,164 - INFO - Updated last_sequence sample during iteration: [[0.07963851 0.         0.         0.        ]
 [0.06025839 0.         0.         0.        ]
 [0.04935845 0.         0.         0.        ]
 [0.03581793 0.         0.         0.        ]
 [0.02806727 0.         0.         0.        ]]
2024-06-14 08:08:03,250 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:08:03,250 - INFO - Updated last_sequence sample during iteration: [[0.06025839 0.         0.         0.        ]
 [0.04935845 0.         0.         0.        ]
 [0.03581793 0.         0.         0.        ]
 [0.02806727 0.         0.         0.        ]
 [0.0192094  0.         0.         0.        ]]
2024-06-14 08:08:03,251 - INFO - Future predictions before rescaling: [0.865128   0.9133645  0.93085766 0.94685596 0.8546575  0.84482306
 0.76168823 0.7310616  0.65927553 0.6166124  0.55831826 0.5101397
 0.46323895 0.4143318  0.3763591  0.32983392 0.29866374 0.25633004
 0.2302324  0.19287443 0.17068622 0.13858911 0.12000051 0.09411278
 0.07963851 0.06025839 0.04935845 0.03581793 0.02806727 0.0192094 ]
2024-06-14 08:08:03,252 - INFO - Future predictions after rescaling: [43.64017831 46.06102601 46.93895367 47.74186055 43.11469485 42.62113537
 38.44884762 36.9117877  33.30906138 31.1679255  28.2423186  25.82438152
 23.4705736  21.0160699  19.11033456 16.77537532 15.21103701 13.08643598
 11.77667369  9.90178918  8.78822915  7.17737192  6.24446572  4.94523794
  4.21881798  3.24618777  2.69915255  2.0195944   1.6306122   1.18606197]
2024-06-14 08:08:03,253 - INFO - Future predictions DataFrame:
2024-06-14 08:08:03,254 - INFO -             Future Predictions
2023-12-30           43.640178
2023-12-31           46.061026
2024-01-01           46.938954
2024-01-02           47.741861
2024-01-03           43.114695
2024-06-14 08:08:03,261 - INFO - Plotting results
2024-06-14 08:18:23,997 - INFO - Starting analysis for stock symbol: NVDA
2024-06-14 08:18:23,998 - INFO - Test ratio: 0.2, Future days: 30
2024-06-14 08:18:23,998 - INFO - Downloading stock data for NVDA
2024-06-14 08:18:24,439 - INFO - Downloaded data shape: (3522, 6)
2024-06-14 08:18:24,441 - INFO - Adding technical indicators
2024-06-14 08:18:24,446 - INFO - Technical indicators added. Updated data shape: (3473, 4)
2024-06-14 08:18:24,447 - INFO - Scaling the data
2024-06-14 08:18:24,450 - INFO - Data scaled successfully
2024-06-14 08:18:24,450 - INFO - Preparing dataset
2024-06-14 08:18:24,455 - INFO - Dataset prepared. X shape: (3413, 60, 4), y shape: (3413,)
2024-06-14 08:18:24,455 - INFO - Pre-training model on interpolation task
2024-06-14 08:19:24,434 - INFO - Loading pre-trained weights for extrapolation task
2024-06-14 08:19:24,921 - INFO - Fine-tuning model on extrapolation task
2024-06-14 08:20:45,426 - INFO - Making predictions
2024-06-14 08:20:46,397 - INFO - Rescaling predictions
2024-06-14 08:20:46,398 - INFO - Initial last_sequence shape: (60, 4)
2024-06-14 08:20:46,398 - INFO - Initial last_sequence sample: [[0.88600632 0.09536932 0.90775178 0.96101883]
 [0.90740631 0.10659768 0.90795038 0.96095939]
 [0.89766271 0.09980879 0.90804968 0.96032327]
 [0.90812362 0.08854205 0.90901967 0.9599223 ]
 [0.92820849 0.09116181 0.91040044 0.96005107]]
2024-06-14 08:20:46,399 - INFO - Last sequence before making future predictions: [[0.88600632 0.09536932 0.90775178 0.96101883]
 [0.90740631 0.10659768 0.90795038 0.96095939]
 [0.89766271 0.09980879 0.90804968 0.96032327]
 [0.90812362 0.08854205 0.90901967 0.9599223 ]
 [0.92820849 0.09116181 0.91040044 0.96005107]
 [0.93097813 0.11945354 0.91182615 0.96120359]
 [0.9014087  0.11747673 0.91345778 0.96161102]
 [0.9140415  0.09032886 0.91568311 0.96222045]
 [0.87106221 0.2102082  0.91612002 0.96158346]
 [0.83635202 0.15947483 0.91607508 0.96052052]
 [0.83445915 0.12491185 0.91720813 0.96032542]
 [0.82023235 0.11834066 0.91697504 0.9598943 ]
 [0.85187395 0.11868722 0.91776211 0.96080736]
 [0.86558268 0.09755725 0.91959338 0.9607686 ]
 [0.8280431  0.09671169 0.9188732  0.95983788]
 [0.7990914  0.13581531 0.91598519 0.9584769 ]
 [0.80255843 0.10175791 0.91285049 0.95725203]
 [0.81572915 0.09387369 0.90906565 0.95633121]
 [0.80813753 0.12950047 0.90620481 0.95366654]
 [0.83892244 0.10746325 0.90441117 0.95222675]
 [0.86245442 0.09967088 0.90317569 0.95067197]
 [0.89232273 0.10390362 0.90238444 0.94974254]
 [0.9071871  0.0973571  0.90288407 0.94962755]
 [0.91125195 0.0815733  0.90304817 0.94924855]
 [0.92358581 0.08254773 0.90280568 0.94829672]
 [0.93107778 0.13567685 0.9028109  0.94730011]
 [0.95867453 0.10298101 0.90581494 0.94686081]
 [0.96435329 0.09280659 0.90845419 0.94690862]
 [0.98499607 0.10180452 0.9144309  0.94738582]
 [0.96969335 0.11785564 0.92142569 0.94817269]
 [0.98148921 0.08063863 0.92913857 0.94956768]
 [0.97786279 0.07664909 0.93740751 0.95117243]
 [1.         0.1010275  0.94517787 0.95342536]
 [0.99073465 0.14260008 0.95174307 0.95561067]
 [0.96626615 0.23408542 0.95899394 0.95700223]
 [0.94753623 0.06827025 0.96678103 0.95794759]
 [0.95682149 0.09596675 0.97487333 0.95981764]
 [0.94843284 0.09756493 0.98183467 0.96147794]
 [0.95478907 0.09222232 0.98952768 0.96346772]
 [0.92749118 0.13177011 0.9941738  0.96541917]
 [0.92739154 0.08874357 0.99758026 0.96789477]
 [0.90238504 0.10744954 0.9981081  0.96957445]
 [0.92342642 0.08940187 0.99895998 0.97144536]
 [0.90224556 0.09183436 0.99848753 0.97299239]
 [0.92402416 0.08367295 0.99851052 0.97477028]
 [0.94215634 0.0859763  0.99909168 0.97667263]
 [0.92464181 0.12724098 0.9973064  0.97801982]
 [0.9451651  0.08958529 0.99629983 0.97925805]
 [0.95375298 0.11025958 0.99466088 0.98122673]
 [0.9589734  0.09475215 0.99409854 0.98308256]
 [0.96973318 0.119076   0.99348184 0.98489231]
 [0.99338473 0.10060719 0.99429609 0.98675073]
 [0.98395998 0.11482517 0.99345467 0.98861604]
 [0.95421124 0.09657871 0.99153873 0.98961223]
 [0.97172577 0.06985499 0.99182513 0.99055285]
 [0.9685377  0.056717   0.99292682 0.9913647 ]
 [0.97748419 0.05443941 0.99401074 0.99300907]
 [0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]]
2024-06-14 08:20:46,484 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:46,484 - INFO - Updated last_sequence sample during iteration: [[0.97748419 0.05443941 0.99401074 0.99300907]
 [0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86189592 0.         0.         0.        ]]
2024-06-14 08:20:46,545 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:46,546 - INFO - Updated last_sequence sample during iteration: [[0.98023391 0.0515463  0.99567895 0.99443981]
 [0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86189592 0.         0.         0.        ]
 [0.89833105 0.         0.         0.        ]]
2024-06-14 08:20:46,615 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:46,616 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.05509387 0.99712348 0.99684478]
 [0.98232608 0.09422052 1.         1.        ]
 [0.86189592 0.         0.         0.        ]
 [0.89833105 0.         0.         0.        ]
 [0.90855646 0.         0.         0.        ]]
2024-06-14 08:20:46,691 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:46,691 - INFO - Updated last_sequence sample during iteration: [[0.98232608 0.09422052 1.         1.        ]
 [0.86189592 0.         0.         0.        ]
 [0.89833105 0.         0.         0.        ]
 [0.90855646 0.         0.         0.        ]
 [0.94464648 0.         0.         0.        ]]
2024-06-14 08:20:46,763 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:46,764 - INFO - Updated last_sequence sample during iteration: [[0.86189592 0.         0.         0.        ]
 [0.89833105 0.         0.         0.        ]
 [0.90855646 0.         0.         0.        ]
 [0.94464648 0.         0.         0.        ]
 [0.88215613 0.         0.         0.        ]]
2024-06-14 08:20:46,831 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:46,831 - INFO - Updated last_sequence sample during iteration: [[0.89833105 0.         0.         0.        ]
 [0.90855646 0.         0.         0.        ]
 [0.94464648 0.         0.         0.        ]
 [0.88215613 0.         0.         0.        ]
 [0.89646375 0.         0.         0.        ]]
2024-06-14 08:20:46,898 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:46,898 - INFO - Updated last_sequence sample during iteration: [[0.90855646 0.         0.         0.        ]
 [0.94464648 0.         0.         0.        ]
 [0.88215613 0.         0.         0.        ]
 [0.89646375 0.         0.         0.        ]
 [0.82634878 0.         0.         0.        ]]
2024-06-14 08:20:46,987 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:46,988 - INFO - Updated last_sequence sample during iteration: [[0.94464648 0.         0.         0.        ]
 [0.88215613 0.         0.         0.        ]
 [0.89646375 0.         0.         0.        ]
 [0.82634878 0.         0.         0.        ]
 [0.81968927 0.         0.         0.        ]]
2024-06-14 08:20:47,054 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,055 - INFO - Updated last_sequence sample during iteration: [[0.88215613 0.         0.         0.        ]
 [0.89646375 0.         0.         0.        ]
 [0.82634878 0.         0.         0.        ]
 [0.81968927 0.         0.         0.        ]
 [0.75422621 0.         0.         0.        ]]
2024-06-14 08:20:47,128 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,129 - INFO - Updated last_sequence sample during iteration: [[0.89646375 0.         0.         0.        ]
 [0.82634878 0.         0.         0.        ]
 [0.81968927 0.         0.         0.        ]
 [0.75422621 0.         0.         0.        ]
 [0.73107302 0.         0.         0.        ]]
2024-06-14 08:20:47,210 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,211 - INFO - Updated last_sequence sample during iteration: [[0.82634878 0.         0.         0.        ]
 [0.81968927 0.         0.         0.        ]
 [0.75422621 0.         0.         0.        ]
 [0.73107302 0.         0.         0.        ]
 [0.67424703 0.         0.         0.        ]]
2024-06-14 08:20:47,267 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,267 - INFO - Updated last_sequence sample during iteration: [[0.81968927 0.         0.         0.        ]
 [0.75422621 0.         0.         0.        ]
 [0.73107302 0.         0.         0.        ]
 [0.67424703 0.         0.         0.        ]
 [0.64035821 0.         0.         0.        ]]
2024-06-14 08:20:47,333 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,334 - INFO - Updated last_sequence sample during iteration: [[0.75422621 0.         0.         0.        ]
 [0.73107302 0.         0.         0.        ]
 [0.67424703 0.         0.         0.        ]
 [0.64035821 0.         0.         0.        ]
 [0.5919497  0.         0.         0.        ]]
2024-06-14 08:20:47,414 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,415 - INFO - Updated last_sequence sample during iteration: [[0.73107302 0.         0.         0.        ]
 [0.67424703 0.         0.         0.        ]
 [0.64035821 0.         0.         0.        ]
 [0.5919497  0.         0.         0.        ]
 [0.55253386 0.         0.         0.        ]]
2024-06-14 08:20:47,472 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,473 - INFO - Updated last_sequence sample during iteration: [[0.67424703 0.         0.         0.        ]
 [0.64035821 0.         0.         0.        ]
 [0.5919497  0.         0.         0.        ]
 [0.55253386 0.         0.         0.        ]
 [0.51117611 0.         0.         0.        ]]
2024-06-14 08:20:47,525 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,526 - INFO - Updated last_sequence sample during iteration: [[0.64035821 0.         0.         0.        ]
 [0.5919497  0.         0.         0.        ]
 [0.55253386 0.         0.         0.        ]
 [0.51117611 0.         0.         0.        ]
 [0.47028938 0.         0.         0.        ]]
2024-06-14 08:20:47,591 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,592 - INFO - Updated last_sequence sample during iteration: [[0.5919497  0.         0.         0.        ]
 [0.55253386 0.         0.         0.        ]
 [0.51117611 0.         0.         0.        ]
 [0.47028938 0.         0.         0.        ]
 [0.43447757 0.         0.         0.        ]]
2024-06-14 08:20:47,648 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,649 - INFO - Updated last_sequence sample during iteration: [[0.55253386 0.         0.         0.        ]
 [0.51117611 0.         0.         0.        ]
 [0.47028938 0.         0.         0.        ]
 [0.43447757 0.         0.         0.        ]
 [0.39494812 0.         0.         0.        ]]
2024-06-14 08:20:47,710 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,711 - INFO - Updated last_sequence sample during iteration: [[0.51117611 0.         0.         0.        ]
 [0.47028938 0.         0.         0.        ]
 [0.43447757 0.         0.         0.        ]
 [0.39494812 0.         0.         0.        ]
 [0.36344305 0.         0.         0.        ]]
2024-06-14 08:20:47,773 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,774 - INFO - Updated last_sequence sample during iteration: [[0.47028938 0.         0.         0.        ]
 [0.43447757 0.         0.         0.        ]
 [0.39494812 0.         0.         0.        ]
 [0.36344305 0.         0.         0.        ]
 [0.32701933 0.         0.         0.        ]]
2024-06-14 08:20:47,841 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,841 - INFO - Updated last_sequence sample during iteration: [[0.43447757 0.         0.         0.        ]
 [0.39494812 0.         0.         0.        ]
 [0.36344305 0.         0.         0.        ]
 [0.32701933 0.         0.         0.        ]
 [0.29893881 0.         0.         0.        ]]
2024-06-14 08:20:47,900 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,901 - INFO - Updated last_sequence sample during iteration: [[0.39494812 0.         0.         0.        ]
 [0.36344305 0.         0.         0.        ]
 [0.32701933 0.         0.         0.        ]
 [0.29893881 0.         0.         0.        ]
 [0.2665213  0.         0.         0.        ]]
2024-06-14 08:20:47,974 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:47,974 - INFO - Updated last_sequence sample during iteration: [[0.36344305 0.         0.         0.        ]
 [0.32701933 0.         0.         0.        ]
 [0.29893881 0.         0.         0.        ]
 [0.2665213  0.         0.         0.        ]
 [0.24130103 0.         0.         0.        ]]
2024-06-14 08:20:48,034 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:48,034 - INFO - Updated last_sequence sample during iteration: [[0.32701933 0.         0.         0.        ]
 [0.29893881 0.         0.         0.        ]
 [0.2665213  0.         0.         0.        ]
 [0.24130103 0.         0.         0.        ]
 [0.21319693 0.         0.         0.        ]]
2024-06-14 08:20:48,109 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:48,110 - INFO - Updated last_sequence sample during iteration: [[0.29893881 0.         0.         0.        ]
 [0.2665213  0.         0.         0.        ]
 [0.24130103 0.         0.         0.        ]
 [0.21319693 0.         0.         0.        ]
 [0.19090168 0.         0.         0.        ]]
2024-06-14 08:20:48,166 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:48,166 - INFO - Updated last_sequence sample during iteration: [[0.2665213  0.         0.         0.        ]
 [0.24130103 0.         0.         0.        ]
 [0.21319693 0.         0.         0.        ]
 [0.19090168 0.         0.         0.        ]
 [0.16740516 0.         0.         0.        ]]
2024-06-14 08:20:48,248 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:48,249 - INFO - Updated last_sequence sample during iteration: [[0.24130103 0.         0.         0.        ]
 [0.21319693 0.         0.         0.        ]
 [0.19090168 0.         0.         0.        ]
 [0.16740516 0.         0.         0.        ]
 [0.14785039 0.         0.         0.        ]]
2024-06-14 08:20:48,315 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:48,315 - INFO - Updated last_sequence sample during iteration: [[0.21319693 0.         0.         0.        ]
 [0.19090168 0.         0.         0.        ]
 [0.16740516 0.         0.         0.        ]
 [0.14785039 0.         0.         0.        ]
 [0.12853606 0.         0.         0.        ]]
2024-06-14 08:20:48,395 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:48,395 - INFO - Updated last_sequence sample during iteration: [[0.19090168 0.         0.         0.        ]
 [0.16740516 0.         0.         0.        ]
 [0.14785039 0.         0.         0.        ]
 [0.12853606 0.         0.         0.        ]
 [0.11148999 0.         0.         0.        ]]
2024-06-14 08:20:48,475 - INFO - Updated last_sequence shape during iteration: (60, 4)
2024-06-14 08:20:48,477 - INFO - Updated last_sequence sample during iteration: [[0.16740516 0.         0.         0.        ]
 [0.14785039 0.         0.         0.        ]
 [0.12853606 0.         0.         0.        ]
 [0.11148999 0.         0.         0.        ]
 [0.09586208 0.         0.         0.        ]]
2024-06-14 08:20:48,477 - INFO - Future predictions before rescaling: [0.8618959  0.89833105 0.90855646 0.9446465  0.88215613 0.89646375
 0.8263488  0.8196893  0.7542262  0.731073   0.674247   0.6403582
 0.5919497  0.55253386 0.5111761  0.47028938 0.43447757 0.39494812
 0.36344305 0.32701933 0.2989388  0.2665213  0.24130103 0.21319693
 0.19090168 0.16740516 0.1478504  0.12853606 0.11148999 0.09586208]
2024-06-14 08:20:48,478 - INFO - Future predictions after rescaling: [43.47797082 45.30654057 45.81972349 47.63097315 44.49477023 45.21282667
 41.69396663 41.35974591 38.07435099 36.91236204 34.06043578 32.35965772
 29.9301799  27.9520173  25.8763956  23.82441327 22.02712586 20.0432617
 18.46211634 16.63411944 15.22484222 13.59790483 12.33217489 10.92171458
  9.80278278  8.62356275  7.6421678   6.67283932  5.81734812  5.03303041]
2024-06-14 08:20:48,480 - INFO - Future predictions DataFrame:
2024-06-14 08:20:48,480 - INFO -             Future Predictions
2023-12-30           43.477971
2023-12-31           45.306541
2024-01-01           45.819723
2024-01-02           47.630973
2024-01-03           44.494770
2024-06-14 08:20:48,489 - INFO - Plotting results
